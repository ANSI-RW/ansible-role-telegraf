# Telegraf configuration

# Telegraf is entirely plugin driven. All metrics are gathered from the
# declared plugins.

# Even if a plugin has no configuration, it must be declared in here to be
# active. Declaring a plugin means just specifying the name as a section with
# no variables. To deactivate a plugin, comment out the name and any variables.

# Use 'telegraf -config telegraf.toml -test' to see what metrics a config file
# would generate.

# One rule that plugins conform to is wherever a connection string can be
# passed, the values '' and 'localhost' are treated specially. They indicate
# to the plugin to use their own builtin configuration to connect to the local
# system.

###############################################################################
#                                  TAGS                                       #
###############################################################################

[tags]
{% for item in telegraf_config_tags %}
  {{ item }}
{% endfor %}

###############################################################################
#                                  AGENT                                      #
###############################################################################

[agent]
{% for item in telegraf_config_agent %}
  {{ item }}
{% endfor %}

###############################################################################
#                                  OUTPUTS                                    #
###############################################################################

[outputs]

{% for item in telegraf_config_outputs %}
[[outputs.{{ item.output }}]]
{% if item.config is defined %}
{% for item in item.config %}
  {{ item }}
{% endfor %}
{% endif %}

{% endfor %}

###############################################################################
#                                  PLUGINS                                    #
###############################################################################

[plugins]

{% for item in telegraf_config_plugins %}
[[plugins.{{ item.plugin }}]]
{% if item.config is defined %}
{% for item in item.config %}
  {{ item }}
{% endfor %}
{% endif %}

{% endfor %}

###############################################################################
#                                  SERVICE PLUGINS                            #
###############################################################################

{% for item in telegraf_config_service_plugins %}
[[plugins.{{ item.plugin }}]]
{% if item.config is defined %}
{% for item in item.config %}
  {{ item }}
{% endfor %}
{% endif %}

{% endfor %}
